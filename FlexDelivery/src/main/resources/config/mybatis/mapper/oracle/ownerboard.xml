<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="config.mybatis.mapper.oracle.ownerboard">
	<sql id="searchWhere">
		<where>
			<if test="searchKeyword != null and searchKeyword != ''">
				${searchCondition} like '%' || #{searchKeyword} || '%'
			</if>
		</where>	
	</sql>
	
	
	<sql id="searchWhat">
		<where>
			<if test="boardHead==1">
				 board_head = 1 and authority_no=4
			</if>
			 <if test="boardHead==2">
				 board_head = 2 and authority_no=4
			 </if>
		 </where>	
	</sql>



	<select id="selectAll" parameterType="ownerBoardSearchVo" resultType="ownerBoardVo">
		select *
		from
		(
		    select A.*, rownum as RNUM
		    from
		    (
		        select board_no, board_title,board_regdate,board_thumbNail,board_head,authority_no
		        from board
				<include refid="searchWhere" />	
				<include refid="searchWhat" />	        
		        order by board_regdate
		    )A
		)
		<![CDATA[
		where RNUM > #{firstRecordIndex} 
		and RNUM <= #{firstRecordIndex} + #{recordCountPerPage}
		]]>
	</select>
	
	<select id="selectTotalRecord" parameterType="ownerBoardSearchVo"
		resultType="int">
		select count(*) from board
		<include refid="searchWhere"/>
		<include refid="searchWhat" />
	</select>
	
	
	<select id="selectByNo" parameterType="int" resultType="ownerBoardVo">
		select * from board where board_no=#{boardNo}
	</select>
</mapper>
